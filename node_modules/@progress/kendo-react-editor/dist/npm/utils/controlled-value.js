"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.updateEditorValue = void 0;
var kendo_editor_common_1 = require("@progress/kendo-editor-common");
var index_1 = require("./index");
var setValue = function (view, value) {
    var transaction = value.tr ||
        (view.state.tr
            .setSelection(new kendo_editor_common_1.AllSelection(view.state.doc))
            .replaceSelectionWith(value.doc || index_1.EditorUtils.createDocument(view.state.schema, value.html || ''))
            .setMeta('commandName', 'setHTML'));
    view.updateState(view.state.apply(transaction));
};
/**
 * @hidden
 */
var updateEditorValue = function (view, value, prevValue, trOnChange, htmlOnChange) {
    if (typeof value === 'string') {
        if (trOnChange && value === htmlOnChange) {
            setValue(view, { tr: trOnChange });
        }
        else if (value !== prevValue) {
            setValue(view, { html: value });
        }
    }
    else {
        if (trOnChange && value.eq(trOnChange.doc)) {
            setValue(view, { tr: trOnChange });
        }
        else if (!view.state.doc.eq(value)) {
            setValue(view, { doc: value });
        }
    }
};
exports.updateEditorValue = updateEditorValue;
