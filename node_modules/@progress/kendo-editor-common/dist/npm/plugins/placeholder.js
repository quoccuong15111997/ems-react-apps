"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.placeholder = void 0;
var prosemirror_state_1 = require("prosemirror-state");
var prosemirror_view_1 = require("prosemirror-view");
function placeholder(message) {
    var decAttrs = { class: 'k-placeholder', 'data-placeholder': message };
    return new prosemirror_state_1.Plugin({
        key: new prosemirror_state_1.PluginKey('placeholder'),
        props: {
            decorations: function (state) {
                var doc = state.doc;
                var firstChild = doc.content.firstChild;
                var empty = doc.childCount === 0 ||
                    (doc.childCount === 1 && firstChild.inlineContent && firstChild.childCount === 0);
                if (!empty) {
                    return prosemirror_view_1.DecorationSet.empty;
                }
                var decorations = [];
                doc.descendants(function (node, pos) {
                    decorations.push(prosemirror_view_1.Decoration.node(pos, pos + node.nodeSize, decAttrs));
                });
                return prosemirror_view_1.DecorationSet.create(doc, decorations);
            }
        }
    });
}
exports.placeholder = placeholder;
