"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isAligned = exports.alignBlocks = void 0;
var blockNode_1 = require("./blockNode");
/**
 * Aligning block elements in the selection.
 *
 * @returns {boolean} - Returns true if any alignment is applied.
 */
var alignBlocks = function (actions, commandName) { return function (state, dispatch) {
    var blocks = blockNode_1.blockNodes(state);
    var tr = state.tr;
    tr.setMeta('commandName', commandName);
    blocks.forEach(function (node) {
        if (node.type.isTextblock) {
            var newAttrs = {};
            var action = actions.find(function (n) { return n.node === node.type.name; });
            if (action) {
                newAttrs = blockNode_1.addStyles(node, action.style);
            }
            blockNode_1.changeTextBlock(tr, node, node.type, newAttrs);
        }
    });
    var result = tr.docChanged;
    if (result) {
        dispatch(tr.scrollIntoView());
    }
    return result;
}; };
exports.alignBlocks = alignBlocks;
var isAligned = function (state, actions) {
    var blocks = blockNode_1.blockNodes(state);
    var result = false;
    blocks.forEach(function (node) {
        if (!result && node.type.isTextblock && node.attrs.style) {
            var action = actions.find(function (a) { return a.node === node.type.name; });
            if (action) {
                result = action.style.every(function (style) {
                    return !!style.value && new RegExp(style.name + ":\\s?" + style.value, 'i').test(node.attrs.style);
                });
            }
        }
    });
    return result;
};
exports.isAligned = isAligned;
